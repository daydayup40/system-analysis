### 应用权限管理方案

讨论结果认为的可行的解决方案是由FrameWork层判断某一应用是否被授予了某一运行时权限。<br>
以Camera为例，如果应用申请了Camera权限且被授予运行时权限，此时可以正常访问物理摄像头；如果应用申请了Camera权限但没有被授予运行时权限，此时应用程序不会退出，但是获得的数据来自虚拟摄像头。<br>
因此，需要修改的代码涉及到FrameWork（运行时权限判断）和HAL（虚拟设备）两部分。<br>

##### Camera
系统启动时init.sh挂载的虚拟摄像头驱动vivid；在HAL层中可以通过传参来决定open()物理摄像头还是vivid虚拟摄像头,。
关于与权限管理的关联，认为可行的方案是在FrameWork层中判断出某一应用是否被授予了权限，CameraService中是可以拿到PackageName、PID、UID，而HAL层看不到，通过系统属性property的设置，在HAL层中作出判断并进行摄像头切换，这个在5.1中实现过可行。

- 讨论建议：不建议使用property方式，但具体实现方式目前不确定

##### Audio
按照黄sir的建议可以加载虚拟驱动snd-dummy，但是因为系统支持的音频接口可以有多个，且音频接口中又包含了若干个outputs & inputs，并且每个output & input又包含了若干个devices，这就意味着按照camera方式在HAL层中通过设备节点切换会有大量的修改；而且如果通过虚拟驱动的方式依然绕不过一个大的问题，因为audio并不是某一应用独占，如果切换到虚拟audio，将会影响到所有应用无法使用audio.
所以，讨论结论是在framework层对要过滤的应用程序进行数据流过滤的方式，而不修改底层HAL.

- 讨论建议：audio i/o采用mixer方式，根据权限是否授予，过滤掉相应应用的音频数据

##### GPS
没有现成的虚拟驱动，单纯回传数据的方案考虑不够周全。
应用在使用定位服务时，会优先使用GPS，如果没有则使用WIFI定位的方式，对此与陈老师讨论建议使用一个虚拟GPS设备用于不授权应用，而不需再考虑WIFI定位的情况。

- 讨论建议：做一个软件gps设备，它定期从真实gps中取到信息，然后根据调用者权限返回真假数据

##### 网络、蓝牙等设备
考虑在framework层对过滤的应用使用timeout的方式

#### 上述讨论仍然没有得出如何将某一时刻某一设备是由哪个应用使用的信息传递到HAL的结论
